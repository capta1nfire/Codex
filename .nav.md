# üß≠ CODEX Quick Navigation (Arquitectura Unificada)

> **Prop√≥sito**: Gu√≠a de referencia r√°pida para navegar la arquitectura consolidada del proyecto CODEX. Esta es la fuente de verdad para la estructura del c√≥digo.

## üóÇÔ∏è Directorios Clave (Arquitectura Consolidada)

### üì± Frontend
- **Punto de Entrada de la App**: `/frontend/src/app/page.tsx`
- **Componentes Reutilizables**: `/frontend/src/components/`
- **L√≥gica de Generaci√≥n Central**: `/frontend/src/hooks/useQRGenerationState.ts` (Hook Orquestador)
- **L√≥gica de Autenticaci√≥n**: `/frontend/src/context/AuthContext.tsx`
- **Cliente de API**: `/frontend/src/lib/api.ts`

### üõ†Ô∏è Backend
- **Punto de Entrada del Servidor**: `/backend/src/index.ts`
- **Ruta de QR Unificada**: `/backend/src/routes/qr.unified.routes.ts`
- **Servicio de QR Unificado**: `/backend/src/services/qr.unified.service.ts`
- **Middleware de Seguridad**: `/backend/src/middleware/`
- **Esquemas de Validaci√≥n**: `/backend/src/schemas/`
- **Esquema de Base de Datos**: `/backend/prisma/schema.prisma`

### ü¶Ä Generador Rust
- **Punto de Entrada del Servidor**: `/rust_generator/src/main.rs`
- **Motor de Generaci√≥n v3**: `/rust_generator/src/engine/`
- **L√≥gica de Procesamiento de Im√°genes**: `/rust_generator/src/processing/`
- **Rutas del Generador**: `/rust_generator/src/routes/`

### üìö Documentaci√≥n
- **Hub de Documentaci√≥n**: `/docs/README.md`
- **Documentaci√≥n de API Unificada**: `/docs/API_DOCUMENTATION.md`
- **Gu√≠as de Arquitectura FLODEX**: `/docs/flodex/`
- **Referencia del Motor QR (v3)**: `/docs/qr-engine/QR_ENGINE_V2_REFERENCE.md` (Nombre de archivo a actualizar)
- **Sistema de Dise√±o**: `/docs/CODEX_DESIGN_SYSTEM.md`

## üéØ Flujos de Trabajo Comunes (Arquitectura Consolidada)

### A√±adir Opci√≥n de Personalizaci√≥n de QR
1.  **Generador Rust**: A√±adir l√≥gica en `/rust_generator/src/processing/`.
2.  **Servicio Backend**: Exponer la nueva opci√≥n en `qr.unified.service.ts`.
3.  **Hook Frontend**: A√±adir la opci√≥n en `useQRGenerationState.ts`.
4.  **Componente Frontend**: A√±adir el control de UI en `/frontend/src/components/generator/GenerationOptions.tsx`.

### A√±adir Nuevo Tipo de C√≥digo de Barras (No QR)
1.  **Generador Rust**: A√±adir l√≥gica en `rust_generator/src/lib.rs`.
2.  **Servicio Backend**: Crear o actualizar el servicio correspondiente (ej. `barcode.service.ts`).
3.  **Ruta Backend**: A√±adir la ruta en `backend/src/routes/`.
4.  **Componente Frontend**: A√±adir el nuevo tipo en `BarcodeTypeTabs` y su l√≥gica de formulario.

## üîß Archivos de Configuraci√≥n Cr√≠ticos

- **Gesti√≥n de Servicios**: `/ecosystem.config.js` (PM2)
- **Contenedores**: `/docker-compose.yml`
- **Variables de Entorno (Backend)**: `/backend/.env`
- **Variables de Entorno (Frontend)**: `/frontend/.env.local`

## üìç Comandos R√°pidos Esenciales

### Gesti√≥n de Servicios
```bash
./pm2-start.sh          # Iniciar todos los servicios
./stop-services.sh      # Detener todos los servicios
pm2 logs               # Ver logs en tiempo real
```

### Prueba de API Unificada
```bash
# Prueba del endpoint de QR unificado con opciones avanzadas
curl -X POST http://localhost:3004/api/qr \
  -H "Content-Type: application/json" \
  -d '{
    "data": "https://example.com",
    "options": {
      "customization": {
        "gradient": { "enabled": true, "colors": ["#FF0000", "#0000FF"] },
        "eye_shape": "rounded_square"
      }
    }
  }'
```

### Testing y Validaci√≥n
```bash
# Ejecutar todos los tests del backend
cd backend && npm test

# Ejecutar todos los tests del frontend
cd frontend && npm test

# Validar arquitectura FLODEX
./scripts/validate-flodex.sh
```

## üîç Patrones de B√∫squeda √ötiles

### Encontrar la L√≥gica Central de QR
```bash
# Buscar en el hook orquestador del frontend
grep -r "generateQR" frontend/src/hooks/useQRGenerationState.ts

# Buscar en el servicio unificado del backend
grep -r "generate" backend/src/services/qr.unified.service.ts
```

### Encontrar TODOs y FIXMEs
```bash
grep -r "TODO\|FIXME" --include="*.ts" --include="*.tsx" --include="*.rs"
```

---
*Este documento refleja la arquitectura objetivo despu√©s de la consolidaci√≥n. Usar como gu√≠a para la refactorizaci√≥n.*
